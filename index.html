<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoordViz - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üó∫Ô∏è CoordViz</h1>
            <p class="subtitle">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç</p>
        </header>

        <!-- Main content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="panel">
                    <h2>üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
                    
                    <!-- Text input -->
                    <div class="input-group">
                        <label for="textInput">–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</label>
                        <textarea 
                            id="textInput" 
                            placeholder='–§–æ—Ä–º–∞—Ç—ã:&#10;lat,lon; lat,lon&#10;–∏–ª–∏&#10;{"lat":55.75, "lon":37.62}'
                            rows="5"
                        ></textarea>
                        <button id="parseTextBtn" class="btn btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞</button>
                    </div>

                    <!-- File input -->
                    <div class="input-group">
                        <label for="fileInput">–ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª:</label>
                        <input type="file" id="fileInput" accept=".csv,text/csv" class="file-input">
                        <div class="file-info">
                            <small>–§–æ—Ä–º–∞—Ç: lat, lon, timestamp</small>
                        </div>
                    </div>

                    <!-- Paste area for CSV -->
                    <div class="input-group">
                        <label>–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ CSV (Ctrl+V):</label>
                        <div id="pasteArea" class="paste-area" contenteditable="true" 
                             data-placeholder="–í—Å—Ç–∞–≤—å—Ç–µ CSV –¥–∞–Ω–Ω—ã–µ –∑–¥–µ—Å—å...">
                        </div>
                        <button id="parsePasteBtn" class="btn btn-secondary">–ó–∞–≥—Ä—É–∑–∏—Ç—å CSV –∏–∑ –±—É—Ñ–µ—Ä–∞</button>
                    </div>
                </div>

                <!-- Filters panel -->
                <div class="panel">
                    <h2>üîç –§–∏–ª—å—Ç—Ä—ã</h2>
                    
                    <!-- Date filter -->
                    <div class="filter-group">
                        <label for="monthFilter">–ü–æ –º–µ—Å—è—Ü—É (YYYY-MM):</label>
                        <input type="month" id="monthFilter" class="filter-input">
                        <button id="clearMonthBtn" class="btn btn-small">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>

                    <!-- Date range filter -->
                    <div class="filter-group">
                        <label for="dateFromFilter">–ù–∞—á–∏–Ω–∞—è —Å –¥–∞—Ç—ã:</label>
                        <input type="date" id="dateFromFilter" class="filter-input">
                        <button id="clearDateBtn" class="btn btn-small">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>

                    <!-- Geo radius filter -->
                    <div class="filter-group">
                        <label>–ü–æ –≥–µ–æ—Ä–∞–¥–∏—É—Å—É:</label>
                        <input type="number" id="centerLat" placeholder="–®–∏—Ä–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞" class="filter-input" step="0.000001">
                        <input type="number" id="centerLon" placeholder="–î–æ–ª–≥–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞" class="filter-input" step="0.000001">
                        <input type="number" id="radius" placeholder="–†–∞–¥–∏—É—Å (–∫–º)" class="filter-input" min="0" step="0.1">
                        <button id="applyRadiusBtn" class="btn btn-secondary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                        <button id="clearRadiusBtn" class="btn btn-small">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>

                    <!-- Apply filters -->
                    <button id="applyFiltersBtn" class="btn btn-primary full-width">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                    <button id="clearAllFiltersBtn" class="btn btn-outline full-width">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã</button>
                </div>

                <!-- Data preview -->
                <div class="panel">
                    <h2>üìä –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
                    <div class="stats">
                        <div class="stat-item">
                            <span class="stat-label">–í—Å–µ–≥–æ —Ç–æ—á–µ–∫:</span>
                            <span id="totalPoints" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ:</span>
                            <span id="filteredPoints" class="stat-value">0</span>
                        </div>
                    </div>
                    <button id="showPreviewBtn" class="btn btn-outline full-width">–ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                </div>

                <!-- Render button -->
                <div class="panel">
                    <button id="renderMapBtn" class="btn btn-success full-width">üó∫Ô∏è –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
                    <button id="clearMapBtn" class="btn btn-danger full-width">–û—á–∏—Å—Ç–∏—Ç—å –∫–∞—Ä—Ç—É</button>
                </div>
            </aside>

            <!-- Map container -->
            <main class="map-container">
                <div id="map"></div>
                <div id="messageOverlay" class="message-overlay hidden">
                    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ</p>
                </div>
            </main>
        </div>

        <!-- Preview modal -->
        <div id="previewModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö</h2>
                    <button id="closeModalBtn" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="previewContent" class="preview-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error notification -->
    <div id="notification" class="notification hidden"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
    
    <!-- App JS -->
    <script src="js/utils.js"></script>
    <script src="js/parser.js"></script>
    <script src="js/map.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

