Feature: Импорт координат из строки и CSV
  Как пользователь, я хочу вставить координаты (строкой или CSV),
  чтобы увидеть их на карте.

  Scenario: Happy path — строка "lat,lon; lat,lon"
    Given я ввожу "55.751244,37.618423; 59.9342802,30.3350986"
    When нажимаю "Отобразить"
    Then на карте появляются 2 маркера
    And каждый маркер содержит валидные широту и долготу

  Scenario: Edge case — CSV с заголовками и пустыми строками
    Given я загружаю CSV:
      """
      lat,lon,name
      55.75,37.62,Москва

      59.9343,30.3351,СПб
      """
    When нажимаю "Отобразить"
    Then на карте появляются 2 маркера
    And пустая строка игнорируется
    And значения парсятся из заголовков lat/lon

  Scenario: Edge case — некорректные/вне диапазона значения
    Given я ввожу "190,37.6; 55.7,200"
    When нажимаю "Отобразить"
    Then я вижу сообщение об ошибке "Некорректные координаты"
    And маркеры не добавляются

  Scenario: Кастомный JSON формат
    Given я вставляю JSON:
      """
      {"lat":55.751244, "lon":37.618423}
      {"lat":59.9342802, "lon":30.3350986}
      """
    When нажимаю "Отобразить"
    Then на карте появляются 2 маркера
    And каждый маркер содержит валидные широту и долготу

  Scenario: CSV с timestamp
    Given я загружаю CSV:
      """
      lat,lon,timestamp
      55.75,37.62,2024-01-15
      59.9343,30.3351,2024-02-20
      60.0000,30.2500,2024-03-10
      """
    When нажимаю "Отобразить"
    Then на карте появляются 3 маркера
    And каждый маркер содержит информацию о дате
    And данные доступны для фильтрации по timestamp